
国际惯例的题面:

看到这两个公式，很多人都会想到与gcd有关。没错，最终的结论就是f(a,b)=f(gcd(a,b))*(a/gcd(a,b))*(b/gcd(a,b))。然而结论只能猜出来是不行的，我们考虑如何证明他。
网上很多大神的构造性证明已经很清楚了，然而我太菜，不会构造，让我们来一发非构造性证明。

由于:
我们设x=a+b，则b=x-a，显然我们有前提条件x≠a。
用x替换b，得:
我们移项，得:
如果x≥2*a，我们可以继续迭代:
如果我们让上面两个等式相乘，会发现:
显然迭代下去，我们会有:
如果x=p*a，我们令k=p-1，我们有:
如果我们令(下取整)，我们有:
然而我们现在连右边那个东西能否整除都不知道……没关系，继续展开等式。
我们看到了一个非常愉悦的事情:两个x%a约掉了。
仔细观察，会发现分子上的东西是f的第二个参数的连乘积，分母上的东西是f的第二个参数取模第一个参数的连乘积(废话)。
考虑我们一直迭代下去，最终会剩下什么。
迭代终止的条件是x%a=0，这时候我们带入前面推出x=p*a时适用的公式，的那个这样会剩下分子的前两项和分母的最后两项。
显然分子剩下的前两项为x和a，分母剩下的最后一项为gcd(a,b)，而根据上面迭代的等式，分母的倒数第二项为倒数第二次带入f()的第一个参数，显然也是gcd(a,b)。
至此我们的结论得证(一个证明搞这么麻烦，我好m啊)。

然后就是计算的问题。
我们要求的是:

如果我们能够预处理出g()，O(sqrt(n))修改并O(1)查询f()的前缀和，我们就能在sqrt(n)的复杂度内完成每次操作。
显然维护f()直接大力块状数组即可，重点是g()。

这里有一个很优美的结论，就是
然后我们就有:

之后线性筛φ就好了。

代码(老年选手已经毫不畏惧卡常数):

^去の想い の彼方
过往的思念 记忆中的远方
幼き日 残した悔い
稚气时光中 所留下的懊悔
胸の奥 刻む音(しんおん)
内心深处 铭刻下心音
心だけ 置き忘れたまま
让它留在心里慢慢被遗忘吧
