4609: [Wf2016]Branch Assignment 最短路 DP (阅读理解题)

Bzoj的翻译出锅了所以来官方题面:

这个题应该是单向边而BZOJ说的是双向边，什么你WA了？谁叫你懒得看英文......

显然我们能正向反向两遍SPFA处理出每个点到总部的距离和总部到每个点的距离。
如果某个点所在的部门的大小为S，那么这个点需要送出S-1次消息并接收S-1次消息。
我们把每个点的两个距离求和并排序，显然在一个块中的是这个序列上的一个区间(脑补一下为什么不这样不优)，我们做一下前缀和。
然后就开始DP了，f[i][j]表示前i个点分j个块，最小代价。f[i][j] = min( f[k][j-1] + ( i - k - 1 ) * ( sum[i] - sum[k] ) )。
这个DP是O(n^3)的，考虑优化。
显然更小的边权所在的块应该更大，所以我们能从区间[i-(i/j),i-1]枚举k，这样能优化到n^2logn。
然而有更优美的做法:显然随着j增大，对于每个i最优的k也是递增的，直接指针扫过去，复杂度O(n^2)。
两种做法都可以AC，反正我6代i5的机器上时间差异不大，不知道BZOJ能不能卡出来(我只交了第一种)。
(为什么我现在在刷这种水题？我也不知道啊！！！)

第一种代码:

第二种代码:

良心的我给的数据下载:
链接：https://pan.baidu.com/s/19EmgxmCYDASzpTaqr0alkA 密码：00qr

果てないこのの向こうにも
在无尽的这黑暗的对面
光があると信じてる
我相信也存在光明
ここから生まれ浃铯胧澜绀坤
从此只盯住这脱胎换骨的世界
见つめて离さないよ
目不转睛

冥るこの空を见上げると
仰望这广袤的天空
あの日の椁い映る
那一日的决战映在脑海
いつかは全て消えてしまうのか
终有一天一切将会消失
压猡蛉・せ
重新夺回这荣光
