4923: [Lydsy1706月赛]K小值查询 平衡树 非旋转Treap

国际惯例的题面:

这种维护排序序列，严格大于的进行操作的题都很套路......
我们按照[0,k],(k,2k],(2k,inf)分类讨论一下就好。
显然第一个区间的不会变化，第二个区间的会被平移进第一个区间，第三个区间的相对大小不会变化。
于是我们直接把第二个区间拆了重构，一个一个插入第一个区间即可。因为每次这样做最少减半，所以每个元素只会被重构log次，复杂度nlog^2n。
这种按照值域分离区间的操作，非旋转treap实现起来是最简单的......
然而第一次写非旋转treap还是出了一点问题，注意它的插入是通过按照值域分裂，新建点，再进行两次合并实现的。直接插入复杂度不对。
另外区间值域存在重合的情况两个treap不能直接合并......
我写的判定size的版本复杂度好像不对(不如暴力快？)，于是只好预先生成fix值。

代码:


Thupc被拒了好气啊！我们队可是有yzy大爷的！(即使这样都被拒了，一看就是我太菜了)

ありのままでいればいつも
只要坚守自我维持现状
あるべき私かここにいると
自己希望成为的样貌就存在于此
信じてまた 新しい簸
不要放弃希望 崭新的梦想
精一杯描き出せばいい
再次奋力地去描绘就好
そう荬扭始めたよ私
是啊 而我开始意识到
みんなとただ笑ってる未来を
大家单纯地绽放笑容的未来
粢て
诚心盼望

Xm不会写Treap