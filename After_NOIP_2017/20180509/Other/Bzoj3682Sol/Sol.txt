3682: Phorni 后缀平衡树 线段树

国际惯例的题面:

考虑如果没有强制在线我们能怎么水掉这个题，先构造出字符串，各种方法求一下后缀数组，然后线段树维护区间rank最小的位置即可。
然而他要求强制在线，支持插入后缀，并比较后缀大小(求rank)的数据结构，当然就是后缀平衡树啦。
于是插入字符串的操作，我们只需要在后缀平衡树上插入这个后缀。此时不需要对线段树进行修改，因为线段树中任何一个位置均不包含新插入的这个后缀(保证信息合法)。
什么你说插入会改变每个后缀的rank值？没关系我们不需要知道每个后缀的rank具体是多少，我们只需要它们的相对大小关系，这个显然是不会改变的是吧。
(你还不明白？先去A了"Bzoj3600: 没有人的算术"再说。什么你A了还不明白？丢人！褪裙吧！)
然后对线段树的修改和查询就显然了。
(话说这题treap不旋比旋转快，替罪羊alpha设为1最快，某大佬裸BST直接AC都是什么鬼啊)

代码:


思い出して しいハウリング
回忆起 温柔的振鸣
奏でる声 未来を示してた
演奏之声 昭示了未来
思い出して しいハウリング
回忆起 温柔的共鸣
Wくはない そう教えてくれた
永远不会太迟 你是这样教我的
今までの^ちすべて
至今经历的一切
きすことなんて出来はしない
已不能倒带
g`いをJめる勇
不懂得承认错误的勇气
知らなかったよ 凄く不器用に 生きてた
十分笨拙的生存着

后缀搜索链的正确用法